(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{K9la:function(e,t,a){"use strict";var s=a("p3Ie");a.n(s).a},Mtfu:function(e,t,a){},OZl9:function(e,t,a){"use strict";var s=a("VyHo");a.n(s).a},VyHo:function(e,t,a){},oGLJ:function(e,t,a){"use strict";a.r(t);var s={name:"userInfoShow",props:{dialogVisible:{type:Boolean,default:!1}},data:function(){return{userInfo:{headImg:"",nickname:"",phone:"",sex:1,birth:"",introduce:"",mail:"",level:0,rank:{name:"布衣",imgUrl:""},subscriptions:0,fans:0,integral:0,strategyNum:0,storyNum:0,photoNum:0},visible:this.dialogVisible,loading:!1}},methods:{getUserInfo:function(e){var t=this;this.loading=!0,this.$request.fetchGetUserInfoW({id:e}).then((function(e){200==e.data.code&&(t.userInfo=e.data.data,t.loading=!1)}))},closeCallback:function(){this.$emit("successCallback")}},watch:{dialogVisible:function(){this.visible=this.dialogVisible}},mounted:function(){}},l=(a("qWVN"),a("KHd+")),n=Object(l.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"用户信息",visible:e.visible,width:"600px","destroy-on-close":""},on:{"update:visible":function(t){e.visible=t},close:e.closeCallback}},[e.loading?a("div",{staticClass:"loading"},[a("span",{staticClass:"el-icon-loading"}),e._v("加载中....\n  ")]):[a("el-row",{attrs:{span:24}},[a("el-col",{staticClass:"inner-center",attrs:{span:24}},[e.userInfo.headImg?a("el-image",{staticClass:"avatar",attrs:{src:e.userInfo.headImg,fit:"cover"}}):a("i",{staticClass:"fa fa-user-circle fa-4x",attrs:{"aria-hidden":"true"}})],1)],1),e._v(" "),a("el-row",{staticClass:"user-list",attrs:{span:24}},[a("el-col",{staticClass:"user-list-left",attrs:{span:12}},[a("el-row",{staticClass:"lists"},[a("el-col",[a("span",{staticClass:"left-title"},[e._v("昵称: ")]),e._v("\n            "+e._s(e.userInfo.nickname)+"\n          ")]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("用户名: ")]),e._v("\n            "+e._s(e.userInfo.phone)+"\n          ")]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("性别: ")]),e._v(" "),1===e.userInfo.sex?a("span",[e._v("男")]):2===e.userInfo.sex?a("span",[e._v("女")]):a("span",[e._v("保密")])]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("生日: ")]),e._v("\n            "+e._s(e.userInfo.birth)+"\n          ")]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("个人介绍: ")]),e._v("\n            "+e._s(e.userInfo.introduce)+"\n          ")]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("邮箱: ")]),e._v("\n            "+e._s(e.userInfo.mail)+"\n          ")]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("积分: ")]),e._v("\n            "+e._s(e.userInfo.integral)+"\n          ")])],1)],1),e._v(" "),a("el-col",{staticClass:"user-list-right",attrs:{span:12}},[a("el-row",{staticClass:"lists"},[a("el-col",[a("span",{staticClass:"left-title"},[e._v("等级: ")]),e._v("\n              "+e._s(e.userInfo.level)+"\n          ")]),e._v(" "),a("el-col",{staticClass:"title-show"},[a("span",{staticClass:"left-title"},[e._v("头衔: ")]),e._v(" "),a("el-image",{staticClass:"title",attrs:{src:e.userInfo.rank.imgUrl,fit:"cover"}})],1),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("关注: ")]),e._v("\n              "+e._s(e.userInfo.subscriptions)+"\n          ")]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("粉丝: ")]),e._v("\n              "+e._s(e.userInfo.fans)+"\n          ")]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("攻略: ")]),e._v("\n              "+e._s(e.userInfo.strategyNum)+"\n          ")]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("故事: ")]),e._v("\n              "+e._s(e.userInfo.storyNum)+"\n          ")]),e._v(" "),a("el-col",[a("span",{staticClass:"left-title"},[e._v("动态: ")]),e._v("\n              "+e._s(e.userInfo.photoNum)+"\n          ")])],1)],1)],1)]],2)}),[],!1,null,"636be878",null).exports,i={name:"userInfoShow",props:{dialogVisible:{type:Boolean,default:!1}},data:function(){return{userId:"",userInfo:{headImg:"",nickname:"",gender:1,birth:"",introduce:"",mail:""},updialogImageUrl:"",updialogVisible:!1,hideUpload:!1,visible:this.dialogVisible,loading:!1,rules:{nickname:[{required:!0,message:"请输入用户昵称",trigger:"blur"},{max:10,message:"长度最大为10个字符串",trigger:"blur"}],gender:[{required:!0,message:"请选择用户性别",trigger:"change"}],birth:[{required:!0,message:"请选择用户生日",trigger:"change"}],introduce:[{max:50,message:"长度最大为50个字符串",trigger:"blur"}],mail:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],headImg:[{required:!0,message:"请上传用户头像",trigger:"change"}]}}},methods:{getUserInfo:function(e){var t=this;this.userId=e,this.loading=!0,this.$request.fetchGetUserInfoW({id:e}).then((function(e){if(200==e.data.code){var a=e.data.data,s=a.headImg,l=a.nickname,n=a.gender,i=a.birth,r=a.introduce,o=a.mail;t.userInfo={headImg:s,nickname:l,gender:n,birth:i,introduce:r,mail:o}}else t.$message.error("数据加载失败");t.loading=!1}))},closeCallback:function(){this.$emit("editCallback")},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.userInfo.id=t.userId,t.$request.fetchUpUserInfo(t.userInfo).then((function(e){200===e.data.code?(t.$message.success("修改成功"),t.closeCallback()):t.$message.error("修改失败")}))}))},handleRemove:function(e,t){this.hideUpload=!1,console.log(e,t)},handlePictureCardPreview:function(e){this.updialogImageUrl=e.url,this.updialogVisible=!0},handleAvatarSuccess:function(e,t){this.userInfo.headImg=e.msg},cmtUpChange:function(e,t){this.hideUpload=t.length>=1}},watch:{dialogVisible:function(){this.visible=this.dialogVisible}},mounted:function(){}},r=(a("K9la"),{name:"userList",components:{userInfoShow:n,userInfoEdit:Object(l.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"用户信息修改",visible:e.visible,width:"600px","destroy-on-close":""},on:{"update:visible":function(t){e.visible=t},close:e.closeCallback}},[e.loading?a("div",{staticClass:"loading"},[a("span",{staticClass:"el-icon-loading"}),e._v("加载中....\n  ")]):[a("el-form",{ref:"ruleForm",attrs:{model:e.userInfo,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{model:{value:e.userInfo.nickname,callback:function(t){e.$set(e.userInfo,"nickname",t)},expression:"userInfo.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"gender"}},[a("el-radio-group",{model:{value:e.userInfo.gender,callback:function(t){e.$set(e.userInfo,"gender",t)},expression:"userInfo.gender"}},[a("el-radio",{attrs:{label:1}},[e._v("男")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("女")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("保密")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"生日",prop:"birth"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.userInfo.birth,callback:function(t){e.$set(e.userInfo,"birth",t)},expression:"userInfo.birth"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"个人简介",prop:"introduce"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},maxlength:"50","show-word-limit":""},model:{value:e.userInfo.introduce,callback:function(t){e.$set(e.userInfo,"introduce",t)},expression:"userInfo.introduce"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"mail"}},[a("el-input",{model:{value:e.userInfo.mail,callback:function(t){e.$set(e.userInfo,"mail",t)},expression:"userInfo.mail"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户头像",prop:"headImg"}},[a("el-card",[a("el-row",{attrs:{span:24}},[a("el-col",{attrs:{span:12}},[e.userInfo.headImg?a("el-image",{staticStyle:{width:"148px",height:"148px"},attrs:{src:e.userInfo.headImg,fit:"cover"}}):e._e()],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-upload",{attrs:{action:e.apiUrl+"/upload/uploadFile","list-type":"picture-card","show-file-list":!1,"on-change":e.cmtUpChange,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-success":e.handleAvatarSuccess}},[a("i",{staticClass:"el-icon-plus"})])],1)],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")])],1)],1)]],2)}),[],!1,null,null,null).exports},data:function(){return{dialogVisible:!1,userId:"",dialogVisibleEdit:!1,tableData:[],multipleSelection:[],emptyText:"加载中...",searchPage:{gender:"",page:1,pageSize:10,phone:""},totalCount:0,totalPage:0}},methods:{handleEdit:function(e,t){this.dialogVisibleEdit=!0,this.$refs.userInfoEdit.getUserInfo(t)},handleDelete:function(e,t){console.log(e,t)},filterTag:function(e,t){return t.gender===e},filterStatus:function(e,t){return console.log(t.status,e),t.status===e},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){this.searchPage.pageSize=e,this.getUserList(this.searchPage)},handleCurrentChange:function(e){this.searchPage.page=e,this.getUserList(this.searchPage)},onSubmit:function(){this.getUserList(this.searchPage)},lookUserInfo:function(e){this.dialogVisible=!0,this.$refs.userInfoShow.getUserInfo(e)},successCallback:function(){this.dialogVisible=!1},editCallback:function(){this.dialogVisibleEdit=!1},setStatus:function(e,t){var a=this;switch(t){case 1:this.$request.fetchSetUserStatus({userId:e,status:2}).then((function(t){200===t.data.code&&(a.tableData.forEach((function(t,s){t.id===e&&(a.tableData[s].status=2)})),a.$message.success({message:"修改成功"}))}));break;case 2:this.$request.fetchSetUserStatus({userId:e,status:1}).then((function(t){200===t.data.code&&(a.tableData.forEach((function(t,s){t.id===e&&(a.tableData[s].status=1)})),a.$message.success({message:"修改成功"}))}))}},setStatusAll:function(){var e=this;this.$confirm("您勾选的确定全部禁用吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"批量禁用成功!"})})).catch((function(){e.$message({type:"info",message:"已取消操作"})}))},getUserList:function(e){var t=this;this.$request.fetchGetUserList(e).then((function(e){200===e.data.code?(t.tableData=e.data.data.list,t.searchPage.page=e.data.data.currPage,t.totalCount=e.data.data.totalCount,t.totalPage=e.data.data.totalPage):t.$message.error("数据加载失败"),t.emptyText="暂无数据"}))}},mounted:function(){this.getUserList(this.searchPage)},watch:{"searchPage.phone":{handler:function(e){0===e.length&&(this.searchPage.page=1,this.getUserList(this.searchPage))}}}}),o=(a("OZl9"),Object(l.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[[a("el-card",[a("el-row",{attrs:{span:24}},[a("el-col",{attrs:{span:12}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchPage}},[a("el-form-item",{attrs:{label:"用户查询"}},[a("el-input",{attrs:{placeholder:"请输入手机号码查询"},model:{value:e.searchPage.phone,callback:function(t){e.$set(e.searchPage,"phone",t)},expression:"searchPage.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("el-select",{attrs:{placeholder:"选择用户性别"},model:{value:e.searchPage.gender,callback:function(t){e.$set(e.searchPage,"gender",t)},expression:"searchPage.gender"}},[a("el-option",{attrs:{label:"男",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"女",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"保密",value:"3"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1),e._v(" "),e.multipleSelection.length>0?a("el-col",{attrs:{span:12,align:"right"}},[a("el-button",{directives:[{name:"role-btn",rawName:"v-role-btn",value:"80",expression:"'80'"}],attrs:{type:"danger"},on:{click:e.setStatusAll}},[e._v("一键禁用所有用户")])],1):e._e()],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":e.emptyText},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"ID",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"昵称",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.row.nickname))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"gender",label:"性别",filters:[{text:"男",value:1},{text:"女",value:2},{text:"保密",value:3}],"filter-method":e.filterTag,"filter-placement":"bottom-end",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.gender?a("el-tag",{attrs:{"disable-transitions":""}},[e._v("男")]):2===t.row.gender?a("el-tag",{attrs:{type:"success","disable-transitions":""}},[e._v("女")]):a("el-tag",{attrs:{type:"warning","disable-transitions":""}},[e._v("保密")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"手机号",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.phone))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发帖数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"medium"}},[e._v("攻略: "+e._s(t.row.strategyNum))]),e._v(" "),a("el-tag",{attrs:{size:"medium"}},[e._v("故事: "+e._s(t.row.storyNum))]),e._v(" "),a("el-tag",{attrs:{size:"medium"}},[e._v("动态: "+e._s(t.row.photoNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"注册时间",width:"250",align:"center",prop:"createTime",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-time"}),e._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",filters:[{text:"启用",value:1},{text:"禁用",value:2}],"filter-method":e.filterStatus,"filter-placement":"bottom-end",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"right"}},[a("p",[e._v("点击修改状态")]),e._v(" "),a("div",{directives:[{name:"role-btn",rawName:"v-role-btn",value:"80",expression:"'80'"}],staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[1===t.row.status?a("el-tag",{attrs:{type:"success","close-transition":""},on:{click:function(a){return e.setStatus(t.row.id,1)}}},[e._v("启用")]):a("el-tag",{attrs:{type:"danger","close-transition":""},on:{click:function(a){return e.setStatus(t.row.id,2)}}},[e._v("禁用")])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"role-btn",rawName:"v-role-btn",value:"53",expression:"'53'"}],attrs:{size:"mini"},on:{click:function(a){return e.lookUserInfo(t.row.id)}}},[e._v("查看")]),e._v(" "),a("el-button",{directives:[{name:"role-btn",rawName:"v-role-btn",value:"54",expression:"'54'"}],attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleEdit(t.$index,t.row.id)}}},[a("i",{staticClass:"el-icon-edit"}),e._v("编辑\n          ")]),e._v(" "),a("el-button",{directives:[{name:"role-btn",rawName:"v-role-btn",value:"55",expression:"'55'"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-delete"}),e._v("删除\n          ")])]}}])})],1)],e._v(" "),[a("el-card",[a("el-pagination",{attrs:{"page-size":e.searchPage.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount,"prev-text":"上一页","next-text":"下一页"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],e._v(" "),[a("user-info-show",{ref:"userInfoShow",attrs:{dialogVisible:e.dialogVisible},on:{successCallback:e.successCallback}})],e._v(" "),[a("user-info-edit",{ref:"userInfoEdit",attrs:{dialogVisible:e.dialogVisibleEdit},on:{editCallback:e.editCallback}})]],2)}),[],!1,null,"e7837546",null));t.default=o.exports},p3Ie:function(e,t,a){},qWVN:function(e,t,a){"use strict";var s=a("Mtfu");a.n(s).a}}]);
//# sourceMappingURL=4.17d41f2ff3a4c339d2a2.js.map